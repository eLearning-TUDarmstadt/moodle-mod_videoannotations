define(["jquery","core/ajax","core/templates","core/notification"],function(a,b,c,d){var e=function(d){g("annotationsloader"),a(".annotation").css("visibility","hidden");var e=a.Deferred(),f=b.call([{methodname:"mod_videoannotations_get_annotations",args:{id:d},fail:function(a){console.log(a),e.reject()}}]);return f[0].done(function(b){var d={numberOfAnnotations:b.length,annotations:b},f=c.render("mod_videoannotations/annotation_list",d);f.done(function(b,d){a('[data-region="annotation-list"]').replaceWith(b),c.runTemplateJS(d),e.resolve()}),f.fail(function(a){console.log("ERROR!"),console.log(a),e.reject()})}),e.promise()},f=function(c){var d=a.Deferred();return b.call([{methodname:"mod_videoannotations_delete_annotation",args:{annotationid:c},fail:function(){d.reject()},done:function(){d.resolve()}}]),d.promise()},g=function(b){var c=a("#"+b);console.log(c),c.css("visibility","visible")};return{createNewAnnotation:function(){a("#newannotationbutton").on("click",function(){var c=a("#newannotation_modinstance").val();b.call([{methodname:"mod_videoannotations_create_annotation",args:{annotationinstance:c,timeposition:0,duration:10,subject:a("#newannotation_subject").val(),text:a("#newannotation_text").val(),isquestion:a("#newannotation_isquestion").is(":checked"),isanswered:!1},fail:d.exception,done:function(){a("#newannotation_subject").val(""),a("#newannotation_text").val(""),e(c)}}])})},deleteAnnotationListener:function(){var b=a("#newannotation_modinstance").val();a(".deleteAnnotationButton").on("click",function(){var c=a(this).attr("annotationid");f(c).done(function(){e(b)})})}}});